<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Variational fit for Binomial mixtures — variational_fit • VIBER</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png" />
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png" />

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Variational fit for Binomial mixtures — variational_fit" />
<meta property="og:description" content="Variational fit for a semi-parametric Dirichelt mixture of Binomial
distributions. The fit convergency can be monitored through the ELBO,
can be run either sequentially (single core) or in parallel. You need
to provide an upper bound on the number of clusters that you want to
obtain, through parameters K. You can explicit the Dirichlet
prior for the concentration of the mixture (alpha_0), as well as
the hyperparmeters of the Beta priors for each mixture component." />
<meta property="og:image" content="/logo.png" />
<meta name="twitter:card" content="summary" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">VIBER</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/VIBER.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/caravagn/VIBER">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Variational fit for Binomial mixtures</h1>
    <small class="dont-index">Source: <a href='https://github.com/caravagn/VIBER/blob/master/R/Wrapper_variational.R'><code>R/Wrapper_variational.R</code></a></small>
    <div class="hidden name"><code>variational_fit.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Variational fit for a semi-parametric Dirichelt mixture of Binomial
distributions. The fit convergency can be monitored through the ELBO,
can be run either sequentially (single core) or in parallel. You need
to provide an upper bound on the number of clusters that you want to
obtain, through parameters <code>K</code>. You can explicit the Dirichlet
prior for the concentration of the mixture (<code>alpha_0</code>), as well as
the hyperparmeters of the Beta priors for each mixture component.</p>
    </div>

    <pre class="usage"><span class='fu'>variational_fit</span>(<span class='no'>x</span>, <span class='no'>y</span>, <span class='kw'>K</span> <span class='kw'>=</span> <span class='fl'>10</span>, <span class='kw'>alpha_0</span> <span class='kw'>=</span> <span class='fl'>1e-06</span>, <span class='kw'>a_0</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>b_0</span> <span class='kw'>=</span> <span class='fl'>1</span>,
  <span class='kw'>max_iter</span> <span class='kw'>=</span> <span class='fl'>5000</span>, <span class='kw'>epsilon_conv</span> <span class='kw'>=</span> <span class='fl'>1e-10</span>, <span class='kw'>samples</span> <span class='kw'>=</span> <span class='fl'>10</span>,
  <span class='kw'>q_init</span> <span class='kw'>=</span> <span class='st'>"prior"</span>, <span class='kw'>trace</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x</th>
      <td><p>A matrix where each column is a dimension of the multivariate Binomial,
and each row is an input point. Values of this matrix represent the number of
successes of independent Bernoulli trials. This matrix and <code>y</code> should have
the same dimension.</p></td>
    </tr>
    <tr>
      <th>y</th>
      <td><p>A matrix where each column is a dimension of the multivariate Binomial,
and each row is an input point. Values of this matrix represent the number of
attempts of independent Bernoulli trials. This matrix and <code>x</code> should have
the same dimension.</p></td>
    </tr>
    <tr>
      <th>K</th>
      <td><p>The maximum number of clusters returned, it should be lower than the
number of rows of <code>x</code> and <code>y</code>. Default is <code>K = 10</code>; lower values
speed up convergence.</p></td>
    </tr>
    <tr>
      <th>alpha_0</th>
      <td><p>The concentration parameter of the Dirichlet mixture. The default
is a stringent fit with <code>alpha = 1e-6</code>.</p></td>
    </tr>
    <tr>
      <th>a_0</th>
      <td><p>Prior Beta hyperparameter. If this values is a scalar than all the
mixture components have the same prior. The default is scalar  <code>a_0 = 1</code>.</p></td>
    </tr>
    <tr>
      <th>b_0</th>
      <td><p>Prior Beta hyperparameter. If this values is a scalar than all the
mixture components have the same prior. The default is scalar  <code>b_0 = 1</code>.</p></td>
    </tr>
    <tr>
      <th>max_iter</th>
      <td><p>Maximum number of fit iterations. The fit is interrupted when
this number of iterations is performed. Default <code>max_iter = 5000</code></p></td>
    </tr>
    <tr>
      <th>epsilon_conv</th>
      <td><p>Epsilon to measure convergence (ELBO absolute difference).</p></td>
    </tr>
    <tr>
      <th>samples</th>
      <td><p>Number of fits computed by the algorithm. Only the best fit is
returned. This value must be greater or equal than 1.</p></td>
    </tr>
    <tr>
      <th>q_init</th>
      <td><p>Initialization of the q-distribution to compute the approximation
of the posterior distributions. This can be set in three different waysL
equal to the prior (<code>q_init = 'prior'</code>), via kmeans clustering
(<code>q_init = 'kmeans'</code>) and capturing points which are private to each
dimension (<code>q_init = 'private'</code>). The default is equal to the prior.</p></td>
    </tr>
    <tr>
      <th>trace</th>
      <td><p>If true the trace computed during the fit is returned (this allows
to check fits a posterirori, make animations etc.). Default is <code>FALSE</code>; this
feature can slow down quite substantially the fit.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>An object of class <code>vb_bmm</code> which contains S3 methods to extract
the fit, plots the results, compute summary statistics etc.</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span>(<span class='no'>mvbmm_example</span>)
<span class='no'>f</span> <span class='kw'>=</span> <span class='fu'>variational_fit</span>(<span class='no'>mvbmm_example</span>$<span class='no'>successes</span>, <span class='no'>mvbmm_example</span>$<span class='no'>trials</span>)</div><div class='output co'>#&gt; <span style='color: #BBBBBB;background-color: #0000BB;'> [ VIBER - variational fit ] 
#&gt; </span><span style='font-weight: bold;'>
#&gt; 	INPUT</span><span style='color: #000000;background-color: #BBBB00;'>
#&gt;   Points</span><span> N = 231 </span><span style='color: #000000;background-color: #BBBB00;'>
#&gt; Clusters</span><span> K = 10 </span><span style='color: #000000;background-color: #BBBB00;'>(max)
#&gt; 
#&gt; Dirichlet</span><span> alpha = 1e-06 </span><span style='color: #000000;background-color: #BBBB00;'>(conc.)
#&gt;      Beta</span><span> a0 = 1; b0 =1 </span><span style='color: #000000;background-color: #BBBB00;'>(shape)
#&gt; 
#&gt;      Beta (posterior)</span><span> prior </span><span style='color: #000000;background-color: #BBBB00;'>
#&gt;  Optimize</span><span> epsilon = 1e-10; steps =5000; r = 10 </span><span style='color: #000000;background-color: #BBBB00;'>
#&gt; 
#&gt; </span><span style='font-weight: bold;'>
#&gt; 
#&gt; BEST FIT
#&gt; 
#&gt; </span><span style='color: #BBBBBB;background-color: #0000BB;'> [ VIBER - Variational inference for Binomial mixtures ] 
#&gt; </span><span style='color: #000000;background-color: #BBBB00;'>
#&gt;     Points</span><span> N = 231 </span><span style='color: #000000;background-color: #BBBB00;'>
#&gt; Dimensions</span><span> W = 2 </span><span style='color: #000000;background-color: #BBBB00;'>
#&gt;        Fit</span><span> CONVERGED (20 steps; eps. 1e-10) with Variational </span><span style='color: #000000;background-color: #BBBB00;'>
#&gt; 
#&gt; Binomial parameters (2 digits rounded)</span><span> 
#&gt;  </span><span style='color: #555555;'># A tibble: 2 x 10</span><span>
#&gt;      C6    C8    C5    C4    C1    C2    C3    C7    C9   C10
#&gt;   </span><span style='color: #555555;font-style: italic;'>&lt;dbl&gt;</span><span> </span><span style='color: #555555;font-style: italic;'>&lt;dbl&gt;</span><span> </span><span style='color: #555555;font-style: italic;'>&lt;dbl&gt;</span><span> </span><span style='color: #555555;font-style: italic;'>&lt;dbl&gt;</span><span> </span><span style='color: #555555;font-style: italic;'>&lt;dbl&gt;</span><span> </span><span style='color: #555555;font-style: italic;'>&lt;dbl&gt;</span><span> </span><span style='color: #555555;font-style: italic;'>&lt;dbl&gt;</span><span> </span><span style='color: #555555;font-style: italic;'>&lt;dbl&gt;</span><span> </span><span style='color: #555555;font-style: italic;'>&lt;dbl&gt;</span><span> </span><span style='color: #555555;font-style: italic;'>&lt;dbl&gt;</span><span>
#&gt; </span><span style='color: #555555;'>1</span><span>  0.5    0    0.25  0.22   0.5   0.5   0.5   0.5   0.5   0.5
#&gt; </span><span style='color: #555555;'>2</span><span>  0.49   0.2  0.25  0      0.5   0.5   0.5   0.5   0.5   0.5
#&gt; </span><span style='color: #000000;background-color: #BBBB00;'>
#&gt; Proportions (ordered)</span><span>  </span><span style='color: #000000;background-color: #BBBB00;'>
#&gt; </span><span style='color: #555555;'># A tibble: 10 x 2</span><span>
#&gt;    entry         value
#&gt;    </span><span style='color: #555555;font-style: italic;'>&lt;chr&gt;</span><span>         </span><span style='color: #555555;font-style: italic;'>&lt;dbl&gt;</span><span>
#&gt; </span><span style='color: #555555;'> 1</span><span> C6    0.447        
#&gt; </span><span style='color: #555555;'> 2</span><span> C8    0.281        
#&gt; </span><span style='color: #555555;'> 3</span><span> C5    0.202        
#&gt; </span><span style='color: #555555;'> 4</span><span> C4    0.069</span><span style='text-decoration: underline;'>3</span><span>       
#&gt; </span><span style='color: #555555;'> 5</span><span> C1    0.000</span><span style='text-decoration: underline;'>000</span><span>004</span><span style='text-decoration: underline;'>33</span><span>
#&gt; </span><span style='color: #555555;'> 6</span><span> C2    0.000</span><span style='text-decoration: underline;'>000</span><span>004</span><span style='text-decoration: underline;'>33</span><span>
#&gt; </span><span style='color: #555555;'> 7</span><span> C3    0.000</span><span style='text-decoration: underline;'>000</span><span>004</span><span style='text-decoration: underline;'>33</span><span>
#&gt; </span><span style='color: #555555;'> 8</span><span> C7    0.000</span><span style='text-decoration: underline;'>000</span><span>004</span><span style='text-decoration: underline;'>33</span><span>
#&gt; </span><span style='color: #555555;'> 9</span><span> C9    0.000</span><span style='text-decoration: underline;'>000</span><span>004</span><span style='text-decoration: underline;'>33</span><span>
#&gt; </span><span style='color: #555555;'>10</span><span> C10   0.000</span><span style='text-decoration: underline;'>000</span><span>004</span><span style='text-decoration: underline;'>33</span><span>
#&gt; </span><span style='font-weight: bold;'>
#&gt; 
#&gt; COMPLETED: </span><span style='color: #00BBBB;'>0.1 mins, with status CONVERGED 
#&gt; </span><span></div><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span>(<span class='no'>f</span>)</div><div class='output co'>#&gt; </span><span style='color: #BBBBBB;background-color: #0000BB;'> [ VIBER - Variational inference for Binomial mixtures ] 
#&gt; </span><span style='color: #000000;background-color: #BBBB00;'>
#&gt;     Points</span><span> N = 231 </span><span style='color: #000000;background-color: #BBBB00;'>
#&gt; Dimensions</span><span> W = 2 </span><span style='color: #000000;background-color: #BBBB00;'>
#&gt;        Fit</span><span> CONVERGED (20 steps; eps. 1e-10) with Variational </span><span style='color: #000000;background-color: #BBBB00;'>
#&gt; 
#&gt; Binomial parameters (2 digits rounded)</span><span> 
#&gt;  </span><span style='color: #555555;'># A tibble: 2 x 10</span><span>
#&gt;      C6    C8    C5    C4    C1    C2    C3    C7    C9   C10
#&gt;   </span><span style='color: #555555;font-style: italic;'>&lt;dbl&gt;</span><span> </span><span style='color: #555555;font-style: italic;'>&lt;dbl&gt;</span><span> </span><span style='color: #555555;font-style: italic;'>&lt;dbl&gt;</span><span> </span><span style='color: #555555;font-style: italic;'>&lt;dbl&gt;</span><span> </span><span style='color: #555555;font-style: italic;'>&lt;dbl&gt;</span><span> </span><span style='color: #555555;font-style: italic;'>&lt;dbl&gt;</span><span> </span><span style='color: #555555;font-style: italic;'>&lt;dbl&gt;</span><span> </span><span style='color: #555555;font-style: italic;'>&lt;dbl&gt;</span><span> </span><span style='color: #555555;font-style: italic;'>&lt;dbl&gt;</span><span> </span><span style='color: #555555;font-style: italic;'>&lt;dbl&gt;</span><span>
#&gt; </span><span style='color: #555555;'>1</span><span>  0.5    0    0.25  0.22   0.5   0.5   0.5   0.5   0.5   0.5
#&gt; </span><span style='color: #555555;'>2</span><span>  0.49   0.2  0.25  0      0.5   0.5   0.5   0.5   0.5   0.5
#&gt; </span><span style='color: #000000;background-color: #BBBB00;'>
#&gt; Proportions (ordered)</span><span>  </span><span style='color: #000000;background-color: #BBBB00;'>
#&gt; </span><span style='color: #555555;'># A tibble: 10 x 2</span><span>
#&gt;    entry         value
#&gt;    </span><span style='color: #555555;font-style: italic;'>&lt;chr&gt;</span><span>         </span><span style='color: #555555;font-style: italic;'>&lt;dbl&gt;</span><span>
#&gt; </span><span style='color: #555555;'> 1</span><span> C6    0.447        
#&gt; </span><span style='color: #555555;'> 2</span><span> C8    0.281        
#&gt; </span><span style='color: #555555;'> 3</span><span> C5    0.202        
#&gt; </span><span style='color: #555555;'> 4</span><span> C4    0.069</span><span style='text-decoration: underline;'>3</span><span>       
#&gt; </span><span style='color: #555555;'> 5</span><span> C1    0.000</span><span style='text-decoration: underline;'>000</span><span>004</span><span style='text-decoration: underline;'>33</span><span>
#&gt; </span><span style='color: #555555;'> 6</span><span> C2    0.000</span><span style='text-decoration: underline;'>000</span><span>004</span><span style='text-decoration: underline;'>33</span><span>
#&gt; </span><span style='color: #555555;'> 7</span><span> C3    0.000</span><span style='text-decoration: underline;'>000</span><span>004</span><span style='text-decoration: underline;'>33</span><span>
#&gt; </span><span style='color: #555555;'> 8</span><span> C7    0.000</span><span style='text-decoration: underline;'>000</span><span>004</span><span style='text-decoration: underline;'>33</span><span>
#&gt; </span><span style='color: #555555;'> 9</span><span> C9    0.000</span><span style='text-decoration: underline;'>000</span><span>004</span><span style='text-decoration: underline;'>33</span><span>
#&gt; </span><span style='color: #555555;'>10</span><span> C10   0.000</span><span style='text-decoration: underline;'>000</span><span>004</span><span style='text-decoration: underline;'>33</span><span></div></span></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      <li><a href="#value">Value</a></li>
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Giulio Caravagna.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


